{
    "contents" : "\\name{etas}\n\\alias{etas}\n\\title{Fit the space-time ETAS model to data}\n\\description{\n  A function to fit the space-time version of the Epidemic Type Aftershock\n  Sequence (ETAS) model to a catalog of earthquakes (a spatio-temporal point\n  pattern) and perform a stochastic declustering method.\n}\n\\usage{\n etas(object, param0, bwd = NULL, nnp = 5, bwm = 0.05,\n      verbose = TRUE, plot.it = TRUE, no.itr = 11)\n}\n\\arguments{\n  \\item{object}{An object of class \\code{\"catalog\"} containing an\n  earthquake catalog dataset.}\n  \\item{param0}{Initial guess for model parameters. A numeric vector\n                of appropriate length (currently 8).}\n  \\item{bwd}{Optional. Bandwidths for smoothness and integration\n             on the geographical region \\code{win}. A numeric vector\n             which has the length of the number of events.\n             If not supplied, the following arguments \\code{nnp} and\n             \\code{bwm} determine bandwidths.}\n  \\item{nnp}{Number of nearest neighbors for bandwidth calculations. An integer.}\n  \\item{bwm}{Minimum bandwidth. A positive numeric value.}\n  \\item{verbose}{Logical flag indicating whether to print progress reports.}\n  \\item{plot.it}{Logical flag indicating whether plot probabilities of\n    each event being a background event on a map.}\n  \\item{no.itr}{An integer indicating the number of iterations for\n               convergence of the iterative approach of declustering algorithm. See details.}\n}\n\\value{\n  A list with components\n  \\describe{\n    \\item{param:}{The ML estimates of model parameters.}\n    \\item{bk:}{An estimate of the \\eqn{u(x, y)}{u(x, y)}.}\n    \\item{pb:}{The probabilities of being background event.}\n    \\item{opt:}{The results of optimization: the value of the log-likelihood\n      function at the optimum point, its gradient at the optimum point and AIC of the model.}\n    \\item{rates:}{Pixel images of the estimated total intensity,\n          background intensity, clustering intensity and conditional intensity.}\n  }\n}\n\\details{\n  Ogata (1988) introduced the epidemic type aftershock sequence\n  (ETAS) model based on Gutenberg-Richter law and modified Omori law.\n  In its space-time representation (Ogata, 1998), the ETAS model is a\n  temporal marked point process model, and a special case of marked\n  Hawks process, with conditional intensity function\n    \\deqn{\n      \\lambda(t, x, y | H_t) = \\mu(x,y) + \\sum_{t_i < t} k(m_i)g(t - t_i)f(x - x_i, y - y_i|m_i)\n    }{\n      lambda(t, x, y | H_t ) = mu(x, y)\n       + sum[t[i] < t] k(m[i]) g(t - t[i]) f(x - x[i], y - y[i]|m[i])\n    }\n  where\n  \\describe{\n      \\item{\\eqn{H_t}{H_t}: }{is the observational history up to time t, but not\n            including t; that is\n            \\deqn{H_t=\\{(t_i, x_i, y_i, m_i): t_i < t\\}}{H_t = {(t[i], x[i], y[i], m[i]): t[i] < t}}\n           }\n      \\item{\\eqn{\\mu(x,y)}{mu(x, y)}: }{is the background intensity. Currently it\n            is assumed to take the semi-parametric form\n            \\deqn{\\mu(x,y)=\\mu u(x,y)}{mu(x, y) = mu u(x, y)}\n            where \\eqn{\\mu}{mu} is an unknown constant and \\eqn{u(x,y)}{u(x, y)}\n            is an unknown function.\n           }\n      \\item{\\eqn{k(m)}{k(m)}: }{is the expected number of events triggered\n            from an event of magnitude \\eqn{m}{m} given by\n           \\deqn{k(m) = A\\exp(\\alpha(m - m_0))}{k(m[i]) =  A exp(alpha(m - m0))}\n           }\n      \\item{\\eqn{g(t)}{g(t)}: }{is the p.d.f of the occurrence\n            times of the triggered events, taking the form\n           \\deqn{g(t) =  \\frac{p-1}{c}(1 + \\frac{t}{c})^{-p}}{g(t) = ((p - 1)/c)(1 + t/c)^(-p)}\n           }\n      \\item{\\eqn{f(x,y|m)}{f(x, y|m)}: }{is the p.d.f of\n            the locations of the triggered events, considered to be\n            either the long tail inverse power density\n           \\deqn{ f(x, y|m) = \\frac{q-1}{\\pi \\sigma(m))}\n             (1 + \\frac{x^2 + y^2}{\\sigma(m)})^{-q} }{ f(x, y|m) = (q - 1)/(pi sigma(m))\n                 (1 + (x^2 + y^2)/(sigma(m)))^(-q)}\n           or the light tail Gaussian density (currently not implemented)\n           \\deqn{ f(x,y|m)= \\frac{1}{2\\pi \\sigma(m)}\\exp(-\\frac{x^2 + y^2}{2\\sigma(m)}) }{f(x,y|m)= exp(-(x^2 + y^2)/(2 sigma(m)))/(2 pi sigma(m))}\n           with\n           \\deqn{ \\sigma(m) = D\\exp(\\gamma(m - m_0)) }{ sigma(m) = D exp( gamma (m - m0) )}\n       }\n  }\n\n  The ETAS models classify seismicity into two components, background\n  seismicity \\eqn{\\mu(x, y)}{mu(x,y)} and clustering seismicity\n  \\eqn{\\lambda(t, x, y|H_t) - \\mu(x, y)}{lambda(t, x, y|H_t) - mu(x, y)}, where\n  each earthquake event, whether it is a background event or generated by\n  another event, produces its own offspring according to the branching rules\n  controlled by \\eqn{k(m)}{k(m)}, \\eqn{g(m)}{g(m)} and \\eqn{f(x, y|m)}{f(x, y|m)}.\n\n  Background seismicity rate \\eqn{u(x, y)}{u(x, y)} and the model parameters\n  \\deqn{\\theta=(\\mu, A, c, \\alpha, p, D, q, \\gamma)}{theta = (mu, A, c, alpha, p, D, q, gamma)}\n  are estimated simultaneously using an iterative approach proposed in Zhuang et al. (2002).\n  First, for an initial \\eqn{u_0(x, y)}{u0(x, y)}, the parameter vector\n  \\eqn{\\theta}{theta}  is estimated by maximizing the log-likelihood function\n  \\deqn{l(\\theta)=\\sum_{i} \\lambda(t_i, x_i, y_i|H_{t_i}) - \\int \\lambda(t, x, y|H_t) dx dy dt.}{l(theta) = sum_[i] lambda(t[i], x[i], y[i]|H_t)\n         - int lambda(t, x, y|H_t) dx dy dt.}\n  Then the procedure calculates the probability of being a background\n  event for each event in the catalog by\n  \\deqn{ \\phi_i = \\frac{\\mu(x_i, y_i)}{\\lambda(t_i, x_i, y_i|H_{t_i})}. }{mu(x[i], y[i])/lambda(t[i], x[i], y[i]|H_t[i]).}\n  Using these probabilities and kernel smoothing method with Gaussian kernel\n  and appropriate choice of bandwidth (determined by \\code{bwd} or \\code{nnp}\n  and \\code{bwm} arguments), the background rate \\eqn{u_0(x, y)}{u0(x, y)}\n  is updated. These steps are repeated enough times\n  (determined by \\code{no.itr} argument) such that the\n  results converge.\n\n  The procedure is based on a \\code{C} port of the original \\code{Fortran} code\n  by Jiancang Zhuang, Yosihiko Ogata and their colleagues. The Fortran code\n  (implemented for parallel/non-parallel computing) can be obtained from\n  \\url{http://bemlar.ism.ac.jp/zhuang/software.html}.\n}\n\\references{\n  Zhuang, J., Ogata, Y. and Vere-Jones, D. (2005).\n  Diagnostic analysis of space-time branching processes for earthquakes.\n  Lecture Note in Statistics: \\emph{Case Studies in Spatial Point Process Models}\n  (Baddeley, A., Gregori, P., Mateu, J., Stoica, R. and Stoyan, D.),\n  Springer-Verlag, New York, \\bold{185}, 276--292.\n\n  Zhuang, J., Ogata, Y. and Vere-Jones, D. (2002).\n  Stochastic declustering of space-time earthquake occurrences.\n  \\emph{Journal of the American Statistical Association},\n  \\bold{97}, 369--380.\n\n  Ogata, Y. (1998).\n  Space-time point-process models for earthquake occurrences.\n  \\emph{Annals of the Institute of Statistical Mathematics},\n  \\bold{50}, 379--402.\n\n  Ogata, Y. (1988).\n  Statistical models for earthquake occurrences and residual analysis for point processes.\n  \\emph{Journal of American Statistical Association},\n  \\bold{83}, 9--27.\n}\n\\seealso{\n\n  \\code{\\link{catalog}} for constructing data.\n}\n\\examples{\n  # fitting the ETAS model to an Iranian catalog\n\n  data(iran.quakes)\n  summary(iran.quakes)\n\n  # preparing the catalog\n  iran.cat <- catalog(iran.quakes, time.begin=\"1973/01/01\",\n     study.start=\"1996/01/01\", study.end=\"2016/01/01\",\n     lat.range=c(25, 42), long.range=c(42, 63), mag.threshold=4.5)\n\n  print(iran.cat)\n  \\dontrun{\n  plot(iran.cat)}\n\n  # initial parameters values\n  param01 <- c(0.46, 0.23, 0.022, 2.8, 1.12, 0.012, 2.4, 0.35)\n\n  # fitting the model\n  \\dontrun{\n  res <- etas(iran.cat, param0=param01, no.itr=5)\n  }\n\n\n\n  # fitting the ETAS model to a Japanese catalog\n\n  # preparing the catalog\n  jpoly <- list(long=c(134.0, 137.9, 143.1, 144.9, 147.8, 137.8,\n    137.4, 135.1, 130.6), lat=c(31.9, 33.0, 33.2, 35.2, 41.3,\n    44.2, 40.2, 38.0, 35.4))\n  jap.cat <- catalog(jap.quakes, time.begin=\"1930-01-01\",\n      study.start=\"1975-06-01\", study.end=\"2013-01-4\",\n      region.poly=jpoly, mag.threshold=5)\n\n  \\dontrun{\n  plot(jap.cat)\n  }\n\n  # initial parameters values\n  param00 <- c(0.592844590,\n   0.204288231,\n   0.022692883,\n   1.495169224,\n   1.109752319,\n   0.001175925,\n   1.860044210,\n   1.041549634)\n\n  # fitting the model\n  \\dontrun{\n  res <- etas(jap.cat, param0=param00)\n  }\n}\n\\author{Abdollah Jalilian\n  \\email{jalilian@razi.ac.ir}\n}\n\\keyword{spatial}\n\\keyword{math}\n\\keyword{earthquake modeling}\n",
    "created" : 1451978220857.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "135406781",
    "id" : "CAD35672",
    "lastKnownWriteTime" : 1452035808,
    "path" : "~/Dropbox/RCodes/RpkgETAS/ETAS/man/etas.Rd",
    "project_path" : "man/etas.Rd",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_doc"
}